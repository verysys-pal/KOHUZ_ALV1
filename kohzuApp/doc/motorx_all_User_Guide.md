# π“ KOHZU Motor OPI (motorx_all.opi) μ‚¬μ©μ κ°€μ΄λ“

λ³Έ λ¬Έμ„λ” `motorx_all.opi` ν™”λ©΄μ„ ν†µν•΄ KOHZU λ¨ν„°λ¥Ό μ μ–΄ν•κ³  μ„¤μ •ν•λ” λ°©λ²•μ— λ€ν•΄ μ„¤λ…ν•©λ‹λ‹¤.  
μ΄ ν™”λ©΄μ€ EPICS Motor Recordμ μ£Όμ” PVλ“¤μ„ μ‹κ°ν™”ν•μ—¬ λ¨ν„°μ κµ¬λ™, μƒνƒ λ¨λ‹ν„°λ§, νλΌλ―Έν„° μ„¤μ •μ„ μ§€μ›ν•©λ‹λ‹¤.

---

## π— 1. μ£Όμ” PV λ° κΈ°λ¥ μ„¤λ… (Key PVs)

OPI ν™”λ©΄μ κ° μ„μ ―μ€ μ•„λμ EPICS PVλ“¤κ³Ό μ—°κ²°λμ–΄ λ™μ‘ν•©λ‹λ‹¤.  
`$(P)$(M)` μ ‘λ‘μ‚¬(μ: `KOHZU:m1`)λ” μƒλµν•κ³  μ„¤λ…ν•©λ‹λ‹¤.

| PV ν•„λ“ | μ΄λ¦„ / κΈ°λ¥ | μ„¤λ… (Usage & Output) |
| :--- | :--- | :--- |
| **.VAL** | **Target Position (λ©ν‘ μ„μΉ)** | μ΄λ™ν•κ³ μ ν•λ” λ©ν‘ μ„μΉλ¥Ό μ…λ ¥ν•©λ‹λ‹¤. (λ‹¨μ„: EGU, μ: mm)<br>κ°’μ„ μ…λ ¥ν•κ³  μ—”ν„°λ¥Ό μΉλ©΄ λ¨ν„°κ°€ μ΄λ™ν•©λ‹λ‹¤. |
| **.RBV** | **Readback Value (ν„μ¬ μ„μΉ)** | λ¨ν„°μ μ‹¤μ  ν„μ¬ μ„μΉλ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤. (Read-only)<br>μ—”μ½”λ” λλ” μ»¨νΈλ΅¤λ¬λ΅λ¶€ν„° ν”Όλ“λ°± λ°›μ€ κ°’μ…λ‹λ‹¤. |
| **.STOP** | **Emergency Stop (μ •μ§€)** | μ΄λ™ μ¤‘μΈ λ¨ν„°λ¥Ό μ¦‰μ‹ μ •μ§€μ‹ν‚µλ‹λ‹¤. <br>κ°’ `1`μ„ μ“°λ©΄ λ¨ν„°κ°€ κ°μ† μ •μ§€ν•©λ‹λ‹¤. |
| **.JOGF** | **Jog Forward (+λ°©ν–¥ μ΅°κ·Έ)** | λ²„νΌμ„ λ„λ¥΄κ³  μλ” λ™μ•(λλ” ν΄λ¦­ μ‹) +λ°©ν–¥μΌλ΅ μ—°μ† μ΄λ™ν•©λ‹λ‹¤. |
| **.JOGR** | **Jog Reverse (-λ°©ν–¥ μ΅°κ·Έ)** | λ²„νΌμ„ λ„λ¥΄κ³  μλ” λ™μ•(λλ” ν΄λ¦­ μ‹) -λ°©ν–¥μΌλ΅ μ—°μ† μ΄λ™ν•©λ‹λ‹¤. |
| **.HOMF** | **Home Forward (μ›μ  λ³µκ·€)** | +λ°©ν–¥μΌλ΅ μ›μ  μ„Όμ„λ¥Ό μ°Ύμ•„ μ΄λ™ν•μ—¬ μ„μΉλ¥Ό 0μΌλ΅ μ΄κΈ°ν™”ν•©λ‹λ‹¤. |
| **.HOMR** | **Home Reverse (μ›μ  λ³µκ·€)** | -λ°©ν–¥μΌλ΅ μ›μ  μ„Όμ„λ¥Ό μ°Ύμ•„ μ΄λ™ν•μ—¬ μ„μΉλ¥Ό 0μΌλ΅ μ΄κΈ°ν™”ν•©λ‹λ‹¤. |
| **.LVIO** | **Limit Violation (μ†ν”„νΈ λ¦¬λ―ΈνΈ μ„λ°)** | μ„¤μ •λ μ†ν”„νΈ λ¦¬λ―ΈνΈ(HLM/LLM)λ¥Ό λ²—μ–΄λ‚λ ¤ ν•  λ• `1`μ΄ λμ–΄ κ²½κ³ ν•©λ‹λ‹¤. |
| **.HLS** | **High Limit Switch (μƒν• μ„Όμ„)** | ν•λ“μ›¨μ–΄ μƒν• λ¦¬λ―ΈνΈ μ„Όμ„ κ°μ§€ μ—¬λ¶€ (1: κ°μ§€λ¨). |
| **.LLS** | **Low Limit Switch (ν•ν• μ„Όμ„)** | ν•λ“μ›¨μ–΄ ν•ν• λ¦¬λ―ΈνΈ μ„Όμ„ κ°μ§€ μ—¬λ¶€ (1: κ°μ§€λ¨). |
| **.DMOV** | **Done Moving (μ΄λ™ μ™„λ£)** | λ¨ν„°κ°€ μ •μ§€ μƒνƒμ΄λ©΄ `1`, μ΄λ™ μ¤‘μ΄λ©΄ `0`μ…λ‹λ‹¤. |
| **.MSTA** | **Motor Status (μƒνƒ λΉ„νΈ)** | λ¨ν„°μ μƒμ„Έ μƒνƒ(λ°©ν–¥, μ™„λ£, μ—λ¬ λ“±)λ¥Ό λΉ„νΈ ν•„λ“λ΅ λ³΄μ—¬μ¤λ‹λ‹¤. |

---

## π― 2. Calibration (λ³΄μ •) κΈ°λ¥ μ‚¬μ©λ²•

**Calibration**μ€ λ¨ν„°λ¥Ό μ‹¤μ λ΅ μ›€μ§μ΄μ§€ μ•κ³ , **ν„μ¬ μ„μΉ κ°’(μΆν‘ κ°’)λ§ λ³€κ²½**ν•  λ• μ‚¬μ©ν•©λ‹λ‹¤.  
μλ¥Ό λ“¤μ–΄, ν„μ¬ λ¬Όλ¦¬μ  μ„μΉλ¥Ό '0'μΌλ΅ μ •μν•κ³  μ‹¶μ„ λ• μ μ©ν•©λ‹λ‹¤.

### β™οΈ μ‚¬μ© λ°©λ²• (How to use)
1. OPI ν™”λ©΄μ—μ„ **SET** (λλ” `Set Mode`) λ²„νΌμ„ μ°Ύμ•„μ„ ν΄λ¦­ν•©λ‹λ‹¤.
   - `.SET` PVκ°€ `1` (Set λ¨λ“ ν™μ„±ν™”) μƒνƒκ°€ λ©λ‹λ‹¤.
   - μ΄ μƒνƒμ—μ„λ” `.VAL` κ°’μ„ λ³€κ²½ν•΄λ„ **λ¨ν„°κ°€ μ›€μ§μ΄μ§€ μ•μµλ‹λ‹¤.**
2. **Target Position (.VAL)** μ…λ ¥μ°½μ— μ›ν•λ” κ°’(μ: `0` λλ” μ‹¤μ  μΈ΅μ •λ μ„μΉκ°’)μ„ μ…λ ¥ν•©λ‹λ‹¤.
   - EPICS Motor Recordκ°€ λ‚΄λ¶€ μ¤ν”„μ…‹(Offset, `.OFF`)μ„ μλ™μΌλ΅ μ¬κ³„μ‚°ν•©λ‹λ‹¤.
   - `.RBV` κ°’μ΄ μ…λ ¥ν• κ°’μΌλ΅ λ³€κ²½λ©λ‹λ‹¤.
3. λ‹¤μ‹ **Use** (λλ” `Use Mode`) λ²„νΌμ„ λλ¬ **SET** λ¨λ“λ¥Ό ν•΄μ ν•©λ‹λ‹¤.
   - `.SET` PVκ°€ `0` (Use λ¨λ“) μƒνƒλ΅ λμ•„μµλ‹λ‹¤.
   - μ΄μ λ¶€ν„° λ‹¤μ‹ `.VAL` μ…λ ¥ μ‹ λ¨ν„°κ°€ μ΄λ™ν•©λ‹λ‹¤.

---

## π“ 3. HLM vs DHLM μ°¨μ΄μ  (Limits)

λ¦¬λ―ΈνΈ μ„¤μ •μ—λ” λ‘ κ°€μ§€ μΆ…λ¥κ°€ μμΌλ©°, μ„λ΅ λ°€μ ‘ν•κ² μ—°κ΄€λμ–΄ μμµλ‹λ‹¤.

### π”Ή 1) HLM / LLM (User Limits)
- **μ •μ:** **User Coordinate System** (μ‚¬μ©μ μΆν‘κ³„) κΈ°μ¤€μ μƒν•/ν•ν•κ°’μ…λ‹λ‹¤.
- **νΉμ§•:** μ‚¬μ©μκ°€ μ‹¤μ λ΅ μ…λ ¥ν•λ” `.VAL` κ°’μ λ²”μ„λ¥Ό μ ν•ν•©λ‹λ‹¤.
- **λ³€λ™μ„±:** **Calibration(Set Position)μ„ μν–‰ν•κ±°λ‚ λ°©ν–¥(.DIR)μ„ λ°”κΎΈλ©΄ κ°’μ΄ μλ™μΌλ΅ λ°”λ€λ‹λ‹¤.**
- **μ΄μ :** μ‚¬μ©μ μΆν‘κ³„(User Pos) = (Dial Pos Γ— Direction) + Offset κ΄€κ³„μ΄κΈ° λ•λ¬Έμ…λ‹λ‹¤. Offsetμ΄ λ³€ν•λ©΄ User Limitλ„ κ°™μ΄ μ΄λ™ν•΄μ•Ό λ¬Όλ¦¬μ μΈ μ ν• λ²”μ„κ°€ μ μ§€λ©λ‹λ‹¤.

### π”Ή 2) DHLM / DLLM (Dial Limits)
- **μ •μ:** **Dial Coordinate System** (λ‹¤μ΄μ–Ό/λ¬Όλ¦¬μ  μΆν‘κ³„) κΈ°μ¤€μ μƒν•/ν•ν•κ°’μ…λ‹λ‹¤.
- **νΉμ§•:** λ¨ν„°μ κΈ°κµ¬μ μΈ μ΄λ™ κ°€λ¥ λ²”μ„(ν•λ“μ›¨μ–΄ λ¦¬λ―ΈνΈ μ¤μ„μΉ μ•μ½)λ¥Ό μ„¤μ •ν•©λ‹λ‹¤.
- **κ³ μ •μ„±:** User Offsetμ΄λ‚ Direction μ„¤μ •μ΄ λ°”λ€μ–΄λ„ **λ³€ν•μ§€ μ•μµλ‹λ‹¤.** (λ¬Όλ¦¬μ  κΈ°κµ¬ μ„μΉλ” λ¶λ³€)
- **κ΄€κ³„:** `HLM`μ€ `DHLM`μ— μ¤ν”„μ…‹μ„ λ”ν• κ°’μΌλ΅ κ³„μ‚°λμ–΄ ν‘μ‹λ©λ‹λ‹¤.

> **π’΅ μ”μ•½:**  
> λ¬Όλ¦¬μ μΈ μ•μ „ λ²”μ„λ” **DHLM / DLLM**μ— μ„¤μ •ν•κ³ ,  
> μ‚¬μ©μκ°€ λ³΄λ” ν™”λ©΄μƒμ λ¦¬λ―ΈνΈ(HLM / LLM)λ” μ¤ν”„μ…‹μ— λ”°λΌ μλ™μΌλ΅ λ”°λΌμµλ‹λ‹¤.

---

## π”„ 4. scanParam (μ¤μΊ” νλΌλ―Έν„°)

**scanParam**μ€ Motor OPIμ—μ„ κ°„λ‹¨ν• μ¤μΊ”(Step Scan)μ„ μν–‰ν•κΈ° μ„ν•΄ μ‚¬μ©λλ” λ³΄μ΅° λ μ½”λ“ λλ” κΈ°λ¥μ…λ‹λ‹¤.  
μ£Όλ΅ `scanParms.db`μ™€ `scanParms.opi` νμΌμ΄ ν•¨κ» κµ¬μ„±λμ–΄ μμ–΄μ•Ό λ™μ‘ν•©λ‹λ‹¤.

### β™οΈ κµ¬μ„± μ”μ† λ° μ‚¬μ©λ²•
1. **νλΌλ―Έν„° μ„¤μ •:**
   - **Start:** μ¤μΊ” μ‹μ‘ μ„μΉ
   - **End:** μ¤μΊ” μΆ…λ£ μ„μΉ
   - **Step / N Points:** μ΄λ™ λ‹¨κ³„ ν¬κΈ° λλ” ν¬μΈνΈ κ°μ
2. **LOAD λ²„νΌ (`scanParms.LOAD`):**
   - μ„¤μ •ν• Start/End/Step κ°’μ„ κΈ°λ°μΌλ΅ μ¤μΊ” λ μ½”λ“(Scan Record)μ— νλΌλ―Έν„°λ¥Ό μ „μ†΅/κ³„μ‚°ν•©λ‹λ‹¤.
3. **GO λ²„νΌ (`scanParms.GO`):**
   - μ„¤μ •λ μ¤μΊ”μ„ μ‹¤μ λ΅ μ‹μ‘ν•©λ‹λ‹¤.

> **β οΈ μ£Όμ:**  
> `scanParam` κΈ°λ¥μ€ λ³„λ„μ `scanParms.db` λ°μ΄ν„°λ² μ΄μ¤κ°€ IOCμ— λ΅λ“λμ–΄ μμ–΄μ•Ό ν•λ©°,  
> `scanParms.opi` νμΌμ΄ OPI κ²½λ΅μ— μ΅΄μ¬ν•΄μ•Ό νμ—…μ°½μ΄ μ—΄λ¦½λ‹λ‹¤.  
> λ§μ•½ λ²„νΌμ„ λλ¬λ„ λ°μ‘μ΄ μ—†λ‹¤λ©΄ ν•΄λ‹Ή νμΌλ“¤μ΄ λ„λ½λμ—κ±°λ‚ κ²½λ΅ μ„¤μ •μ΄ μ• λ μƒνƒμ…λ‹λ‹¤.

---

### π“ λ¬Έμ„ μ •λ³΄
- **μ‘μ„±μΌ:** 2026.02.19
- **μ‘μ„±μ:** Antigravity AI
- **κ΄€λ ¨ νμΌ:** `motorx_all.opi`, `Instruction.md`




